#include "cut2_gadgets.h"

#include <string>
#include <sstream>
#include <unordered_map>

namespace cut2 {

	static const std::string data = "i i 0\ni u 0\ni d 0\nu i 0\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n4 3\n0 1\n0 2\n0 3\n\ni i 1\ni u 0\ni d 0\nu i 0\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n5 6\n0 1\n0 2\n1 2\n1 4\n2 3\n3 4\n\ni i 1\ni u 1\ni d 0\nu i 0\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n6 8\n0 1\n0 2\n1 2\n1 4\n1 5\n2 3\n2 5\n3 5\n\ni i 1\ni u 1\ni d 1\nu i 0\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n5 5\n0 1\n1 2\n1 4\n2 3\n3 4\n\ni i 1\ni u 0\ni d 0\nu i 1\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n6 8\n0 1\n0 2\n0 3\n0 4\n1 4\n2 3\n3 5\n4 5\n\ni i 1\ni u 1\ni d 0\nu i 1\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n5 5\n0 1\n0 2\n1 4\n2 3\n3 4\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n6 7\n0 1\n0 2\n0 3\n1 4\n2 3\n3 5\n4 5\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 0\nu d 0\nd i 0\nd u 0\nd d 0\n6 7\n0 2\n0 4\n1 2\n1 4\n2 3\n3 5\n4 5\n\ni i 1\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n5 6\n0 2\n0 3\n0 4\n1 3\n1 4\n3 4\n\ni i 2\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n8 11\n0 3\n0 6\n0 7\n1 3\n1 4\n1 5\n1 7\n2 3\n2 4\n2 5\n2 6\n\ni i 2\ni u 2\ni d 0\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n7 9\n0 4\n0 5\n0 6\n1 2\n1 4\n1 6\n2 6\n3 4\n3 5\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n5 4\n0 2\n1 3\n1 4\n2 4\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n7 10\n0 4\n0 5\n0 6\n1 4\n1 5\n1 6\n2 3\n2 4\n2 6\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n7 8\n0 1\n0 6\n1 4\n1 6\n2 4\n2 5\n3 4\n3 5\n\ni i 2\ni u 1\ni d 0\nu i 2\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n7 9\n0 4\n0 5\n0 6\n1 4\n1 6\n2 3\n2 4\n2 5\n3 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n9 14\n0 4\n0 7\n0 8\n1 3\n1 4\n1 5\n1 6\n1 7\n1 8\n2 3\n2 7\n2 8\n3 6\n4 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n8 12\n0 5\n0 6\n0 7\n1 2\n1 4\n1 5\n1 7\n2 5\n2 7\n3 4\n3 6\n4 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 0\nd i 0\nd u 0\nd d 0\n9 13\n0 4\n0 7\n0 8\n1 3\n1 7\n1 8\n2 3\n2 4\n2 5\n2 6\n2 8\n3 6\n4 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 2\nu d 0\nd i 0\nd u 0\nd d 0\n6 7\n0 1\n1 4\n1 5\n2 4\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 0\nd i 0\nd u 0\nd d 0\n6 6\n0 2\n1 4\n1 5\n2 5\n3 4\n3 5\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n5 4\n0 1\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n7 9\n0 3\n0 4\n0 6\n1 3\n1 4\n1 5\n2 3\n2 4\n2 5\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n7 8\n0 3\n0 4\n0 6\n1 3\n1 5\n1 6\n2 3\n2 5\n\ni i 2\ni u 2\ni d 2\nu i 1\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n7 7\n0 3\n0 4\n0 6\n1 4\n1 5\n2 4\n2 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n6 6\n0 2\n0 4\n1 4\n2 3\n3 5\n4 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n9 13\n0 3\n0 4\n0 5\n0 6\n0 8\n1 5\n1 6\n1 7\n2 3\n2 4\n2 7\n3 6\n4 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 1\nu d 1\nd i 0\nd u 0\nd d 0\n9 12\n0 3\n0 4\n0 5\n0 6\n0 8\n1 5\n1 6\n1 7\n2 3\n2 7\n3 6\n4 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 1\nd i 0\nd u 0\nd d 0\n6 6\n0 4\n1 2\n2 4\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 1\nd i 0\nd u 0\nd d 0\n8 9\n0 6\n0 7\n1 4\n1 5\n1 7\n2 4\n2 6\n3 4\n3 6\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 2\nd i 0\nd u 0\nd d 0\n6 5\n0 4\n1 4\n2 3\n3 5\n4 5\n\ni i 1\ni u 0\ni d 0\nu i 1\nu u 0\nu d 0\nd i 1\nd u 0\nd d 0\n5 5\n0 2\n1 2\n1 4\n2 3\n3 4\n\ni i 1\ni u 1\ni d 0\nu i 1\nu u 0\nu d 0\nd i 1\nd u 0\nd d 0\n6 7\n0 1\n0 2\n1 2\n1 4\n2 3\n3 5\n4 5\n\ni i 2\ni u 1\ni d 0\nu i 1\nu u 0\nu d 0\nd i 1\nd u 0\nd d 0\n6 6\n0 1\n0 2\n0 3\n1 4\n2 5\n3 5\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 0\nu d 0\nd i 1\nd u 0\nd d 0\n5 5\n0 1\n0 3\n0 4\n1 2\n3 4\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 0\nu d 0\nd i 1\nd u 0\nd d 0\n6 6\n0 2\n1 2\n1 4\n2 3\n3 5\n4 5\n\ni i 1\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n5 5\n0 2\n1 3\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 10\n0 4\n0 5\n0 6\n1 4\n1 5\n1 6\n2 3\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n8 12\n0 4\n0 6\n0 7\n1 5\n1 7\n2 3\n2 4\n2 5\n2 6\n3 4\n3 6\n4 5\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n3 2\n0 1\n0 2\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 8\n0 2\n0 6\n1 3\n1 5\n2 3\n2 4\n2 5\n3 4\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 7\n0 3\n0 6\n1 2\n1 5\n2 3\n2 4\n4 5\n\ni i 2\ni u 1\ni d 0\nu i 2\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 9\n0 3\n0 5\n0 6\n1 3\n1 5\n1 6\n2 3\n2 4\n2 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n9 14\n0 5\n0 7\n0 8\n1 3\n1 4\n1 7\n1 8\n2 3\n2 4\n2 5\n2 6\n2 7\n3 6\n4 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 7\n0 3\n0 6\n1 3\n1 6\n2 4\n2 5\n3 4\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 0\nd i 1\nd u 0\nd d 0\n7 8\n0 4\n0 5\n0 6\n1 4\n1 5\n1 6\n2 3\n3 4\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 2\nu d 0\nd i 1\nd u 0\nd d 0\n6 6\n0 1\n0 4\n2 4\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 0\nd i 1\nd u 0\nd d 0\n4 4\n0 2\n0 3\n1 2\n1 3\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n4 4\n0 1\n0 2\n0 3\n1 2\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n6 6\n0 2\n1 3\n1 4\n2 3\n3 5\n4 5\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n7 8\n0 1\n0 5\n0 6\n1 2\n1 3\n1 6\n2 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 1\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n7 7\n0 1\n0 2\n0 3\n0 6\n1 5\n2 4\n3 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n5 8\n0 2\n0 3\n0 4\n1 2\n1 3\n1 4\n2 3\n3 4\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n7 7\n0 4\n0 5\n0 6\n1 4\n1 5\n2 3\n2 4\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 1\nu d 1\nd i 1\nd u 0\nd d 0\n8 8\n0 3\n0 7\n1 5\n1 6\n2 5\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 1\nd i 1\nd u 0\nd d 0\n4 3\n0 2\n0 3\n1 2\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 1\nd i 1\nd u 0\nd d 0\n8 8\n0 6\n0 7\n1 5\n1 6\n2 5\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 2\nd i 1\nd u 0\nd d 0\n5 5\n0 3\n1 3\n1 4\n2 3\n3 4\n\ni i 1\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n5 4\n0 2\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n7 8\n0 3\n0 6\n1 3\n1 4\n1 6\n2 3\n2 4\n2 5\n\ni i 2\ni u 2\ni d 0\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n6 5\n0 1\n0 2\n1 4\n2 5\n3 5\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n4 4\n0 1\n0 2\n0 3\n1 3\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n6 6\n0 1\n0 2\n1 3\n1 4\n3 5\n4 5\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n5 6\n0 1\n0 2\n0 4\n1 4\n2 3\n2 4\n\ni i 2\ni u 1\ni d 0\nu i 2\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n7 8\n0 4\n0 5\n0 6\n1 4\n1 6\n2 3\n2 4\n2 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n9 13\n0 3\n0 5\n0 8\n1 4\n1 6\n1 8\n2 3\n2 4\n2 5\n2 6\n2 7\n3 6\n4 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n7 8\n0 3\n0 5\n0 6\n1 3\n1 6\n2 3\n2 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 0\nd i 1\nd u 1\nd d 0\n7 7\n0 3\n0 5\n0 6\n1 3\n1 6\n2 3\n2 4\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 2\nu d 0\nd i 1\nd u 1\nd d 0\n6 6\n0 1\n1 4\n1 5\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 0\nd i 1\nd u 1\nd d 0\n4 3\n0 2\n0 3\n1 3\n\ni i 1\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n5 7\n0 1\n0 2\n0 3\n0 4\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n4 3\n0 1\n0 3\n1 2\n\ni i 2\ni u 2\ni d 1\nu i 1\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n5 6\n0 1\n0 2\n0 4\n1 4\n2 3\n3 4\n\ni i 2\ni u 2\ni d 2\nu i 1\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n5 6\n0 1\n0 3\n1 2\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n5 7\n0 2\n0 3\n0 4\n1 2\n1 4\n2 3\n3 4\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n7 6\n0 4\n0 6\n1 3\n1 4\n2 4\n2 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 1\nu d 1\nd i 1\nd u 1\nd d 0\n8 8\n0 5\n0 7\n1 5\n1 6\n2 5\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 1\nd i 1\nd u 1\nd d 0\n4 2\n0 3\n1 2\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 1\nd i 1\nd u 1\nd d 0\n6 7\n0 2\n0 4\n1 2\n1 4\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 2\nd i 1\nd u 1\nd d 0\n5 4\n0 3\n1 4\n2 3\n3 4\n\ni i 2\ni u 1\ni d 0\nu i 2\nu u 1\nu d 0\nd i 2\nd u 1\nd d 0\n7 7\n0 4\n0 6\n1 4\n1 6\n2 3\n2 4\n2 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 1\nu d 0\nd i 2\nd u 1\nd d 0\n9 12\n0 3\n0 8\n1 4\n1 6\n1 8\n2 3\n2 4\n2 5\n2 6\n2 7\n3 6\n4 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 0\nd i 2\nd u 1\nd d 0\n7 7\n0 3\n0 6\n1 3\n1 6\n2 3\n2 4\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 0\nd i 2\nd u 1\nd d 0\n8 9\n0 4\n0 7\n1 2\n1 4\n1 7\n2 3\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 2\nu d 0\nd i 2\nd u 1\nd d 0\n8 9\n0 6\n0 7\n1 4\n1 7\n2 4\n2 7\n3 4\n3 5\n3 6\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 0\nd i 2\nd u 1\nd d 0\n8 8\n0 6\n0 7\n1 4\n1 7\n2 4\n2 7\n3 4\n3 5\n\ni i 2\ni u 1\ni d 1\nu i 2\nu u 1\nu d 1\nd i 2\nd u 1\nd d 0\n5 6\n0 2\n0 4\n1 2\n1 4\n2 3\n3 4\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 1\nu d 1\nd i 2\nd u 1\nd d 0\n8 9\n0 4\n0 7\n1 2\n1 4\n1 7\n2 4\n2 6\n3 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 1\nu d 1\nd i 2\nd u 1\nd d 0\n9 12\n0 5\n0 8\n1 2\n1 3\n1 5\n1 8\n2 5\n2 7\n3 5\n3 7\n4 5\n4 6\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 1\nd i 2\nd u 1\nd d 0\n6 8\n0 1\n0 5\n1 2\n1 4\n2 3\n2 5\n3 4\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 1\nd i 2\nd u 1\nd d 0\n6 7\n0 2\n0 3\n0 4\n1 2\n1 4\n2 5\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 2\nd i 2\nd u 1\nd d 0\n6 6\n0 2\n0 3\n0 4\n1 4\n2 5\n3 5\n\ni i 2\ni u 2\ni d 0\nu i 2\nu u 2\nu d 0\nd i 2\nd u 2\nd d 0\n6 5\n0 1\n1 4\n1 5\n2 5\n3 5\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 0\nd i 2\nd u 2\nd d 0\n5 4\n0 4\n1 4\n2 3\n2 4\n\ni i 2\ni u 2\ni d 1\nu i 2\nu u 2\nu d 1\nd i 2\nd u 2\nd d 0\n5 4\n0 4\n1 4\n2 3\n3 4\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 1\nd i 2\nd u 2\nd d 0\n6 6\n0 2\n0 4\n1 2\n1 4\n2 5\n3 5\n\ni i 2\ni u 2\ni d 2\nu i 2\nu u 2\nu d 2\nd i 2\nd u 2\nd d 0\n6 4\n0 4\n1 4\n2 5\n3 5!";

	static std::unordered_map <uint16_t, Gadget> gadgets;

	void init_gadgets() {
		std::istringstream iss(data);
		while (iss.peek() != '!') {
			Costs costs;
			for (int i = 0; i < 9; i++) {
				char cc1, cc2; iss >> cc1 >> cc2;
				State c1 = cc1 == 'd' ? State::D : cc1 == 'i' ? State::I : State::U;
				State c2 = cc2 == 'd' ? State::D : cc2 == 'i' ? State::I : State::U;
				uint16_t cost; iss >> cost;
				costs.set_cost(c1, c2, cost);
			}
			int N, M; iss >> N >> M;
			Gadget gadget;
			gadget.N = N -= 2;
			gadget.M = M;
			for (int i = 0; i < M; i++) {
				size_t u, v; iss >> u >> v;
				assert(0 <= u && u < gadget.N + 2);
				assert(0 <= v && v < gadget.N + 2);
				gadget.edges.emplace_back(u, v);
			}
			gadgets[costs.mask] = gadget;
		}
	}

	bool has_gadget(Costs costs) {
		return gadgets.find(costs.mask) != gadgets.end();
	}

	Gadget get_gadget(Costs costs) {
		return gadgets[costs.mask];
	}

}
